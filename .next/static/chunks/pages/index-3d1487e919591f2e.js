(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(5487)}])},5487:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var s=n(5893),a=n(7294),l=n(1664),o=n.n(l);function r(e){let{onDone:t}=e;const[n,l]=(0,a.useState)(""),[o,r]=(0,a.useState)(""),[i,c]=(0,a.useState)("");return(0,s.jsxs)("div",{className:"bg-white border rounded-2xl p-4 shadow-sm space-y-3",children:[(0,s.jsx)("div",{className:"font-medium",children:"\u041f\u0440\u0438\u0432\u0435\u0442! \u042f \u2014 \u0422\u0430\u0442\u044c\u044f\u043d\u0430, \u0442\u0432\u043e\u0439 \u0430\u0441\u0441\u0438\u0441\u0442\u0435\u043d\u0442 \u043f\u043e \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u044e."}),(0,s.jsxs)("div",{className:"text-sm text-gray-700",children:["\u042f \u043f\u043e\u043c\u043e\u0433\u0443 \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f \u043a \u0432\u0440\u0430\u0447\u0443, \u043e\u0442\u0432\u0435\u0442\u0438\u0442\u044c \u043d\u0430 \u0432\u043e\u043f\u0440\u043e\u0441\u044b \u043f\u043e \u043f\u0440\u0435\u043f\u0430\u0440\u0430\u0442\u0430\u043c \u0438 \u043d\u0430\u043f\u043e\u043c\u0438\u043d\u0430\u0442\u044c \u043e \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\u0445.",(0,s.jsx)("br",{}),"\u0427\u0442\u043e\u0431\u044b \u043b\u0443\u0447\u0448\u0435 \u043f\u043e\u0434\u0441\u0442\u0440\u043e\u0438\u0442\u044c\u0441\u044f, \u0441\u043a\u0430\u0436\u0438, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430: \u0432\u043e\u0437\u0440\u0430\u0441\u0442, \u0440\u043e\u0441\u0442 \u0438 \u0432\u0435\u0441."]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,s.jsx)("input",{placeholder:"\u0412\u043e\u0437\u0440\u0430\u0441\u0442",value:n,onChange:e=>l(e.target.value),className:"px-3 py-2 border rounded-xl"}),(0,s.jsx)("input",{placeholder:"\u0420\u043e\u0441\u0442 (\u0441\u043c)",value:o,onChange:e=>r(e.target.value),className:"px-3 py-2 border rounded-xl"}),(0,s.jsx)("input",{placeholder:"\u0412\u0435\u0441 (\u043a\u0433)",value:i,onChange:e=>c(e.target.value),className:"px-3 py-2 border rounded-xl"})]}),(0,s.jsx)("button",{onClick:()=>{const e={age:n||null,height:o||null,weight:i||null};localStorage.setItem("benehab_demographics",JSON.stringify(e)),null===t||void 0===t||t(e)},className:"px-4 py-2 rounded-xl bg-emerald-600 text-white",children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"})]})}function i(){var e,t,n,l;const[i,c]=(0,a.useState)([{role:"assistant",content:"\u041f\u0440\u0438\u0432\u0435\u0442! \u042f \u2014 \u0422\u0430\u0442\u044c\u044f\u043d\u0430, \u0442\u0432\u043e\u0439 \u0430\u0441\u0441\u0438\u0441\u0442\u0435\u043d\u0442 \u043f\u043e \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u044e. \u0420\u0430\u0441\u0441\u043a\u0430\u0436\u0438, \u0447\u0442\u043e \u0431\u0435\u0441\u043f\u043e\u043a\u043e\u0438\u0442. \u0415\u0441\u043b\u0438 \u0441\u0442\u0430\u043d\u0435\u0442 \u0441\u043e\u0432\u0441\u0435\u043c \u043f\u043b\u043e\u0445\u043e \u2014 \u043d\u0430\u0436\u043c\u0438 SOS."}]),[d,u]=(0,a.useState)(""),[x,p]=(0,a.useState)(!1),[m,h]=(0,a.useState)(!1),[b,g]=(0,a.useState)(!1),[f,v]=(0,a.useState)(null);(0,a.useEffect)((()=>{const e=!!localStorage.getItem("benehab_demographics"),t=!!localStorage.getItem("benehab_attitude_profile"),n=!!localStorage.getItem("benehab_typology_profile"),s=localStorage.getItem("benehab.pib");if(h(e),g(!(t&&n)),s)try{v(JSON.parse(s))}catch(a){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 PIB:",a)}}),[]);const y=(0,a.useRef)(null);(0,a.useEffect)((()=>{y.current&&(y.current.scrollTop=y.current.scrollHeight)}),[i]);const N=async e=>{if(!e.trim())return;const t=[...i,{role:"user",content:e}];c(t),u(""),p(!0);try{const e=await(async()=>{if(f)return f;const e=JSON.parse(localStorage.getItem("benehab_attitude_profile")||"null"),t=JSON.parse(localStorage.getItem("benehab_typology_profile")||"null");if(!e&&!t)return null;try{const n=await fetch("/api/profiling/pib",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({attitude_profile:e,typology_profile:t})}),s=await n.json();if(s.pib)return localStorage.setItem("benehab.pib",JSON.stringify(s.pib)),v(s.pib),s.pib}catch(n){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f PIB:",n)}return null})(),n=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:t,meta:{pib:e}})}),s=await n.json();c((e=>[...e,{role:"assistant",content:s.content||"\u0413\u043e\u0442\u043e\u0432\u043e."}]))}catch(n){c((e=>[...e,{role:"assistant",content:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439 \u0435\u0449\u0451 \u0440\u0430\u0437."}]))}finally{p(!1)}},j=async e=>{let t="";switch(e){case"anxious":t="\u042f \u043e\u0447\u0435\u043d\u044c \u043f\u0435\u0440\u0435\u0436\u0438\u0432\u0430\u044e \u043e \u0441\u0432\u043e\u0435\u043c \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u0435. \u041c\u043d\u0435 \u043d\u0443\u0436\u043d\u0430 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u0438 \u043f\u043e\u043d\u0438\u043c\u0430\u043d\u0438\u0435.";break;case"drug_info":t="\u0420\u0430\u0441\u0441\u043a\u0430\u0436\u0438, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u0440\u043e \u043f\u0440\u0435\u043f\u0430\u0440\u0430\u0442. \u041c\u043d\u0435 \u043d\u0443\u0436\u043d\u0430 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u043e\u043a\u0430\u0437\u0430\u043d\u0438\u044f\u0445, \u043f\u0440\u043e\u0442\u0438\u0432\u043e\u043f\u043e\u043a\u0430\u0437\u0430\u043d\u0438\u044f\u0445 \u0438 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0445 \u043f\u043e\u0431\u043e\u0447\u043d\u044b\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u0430\u0445.";break;case"where_to_go":t="\u041a\u0443\u0434\u0430 \u043c\u043d\u0435 \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u044c\u0441\u044f \u0437\u0430 \u043f\u043e\u043c\u043e\u0449\u044c\u044e? \u041c\u043d\u0435 \u043d\u0443\u0436\u0435\u043d \u0441\u043e\u0432\u0435\u0442 \u043f\u043e \u0432\u044b\u0431\u043e\u0440\u0443 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0441\u0442\u0430 \u0438\u043b\u0438 \u043a\u043b\u0438\u043d\u0438\u043a\u0438.";break;case"book":t="\u0425\u043e\u0447\u0443 \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f \u043a \u0432\u0440\u0430\u0447\u0443. \u041f\u043e\u043c\u043e\u0433\u0438 \u043c\u043d\u0435 \u0441 \u044d\u0442\u0438\u043c, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430.";break;case"reminder":t="\u041d\u0430\u043f\u043e\u043c\u043d\u0438 \u043c\u043d\u0435 \u0447\u0435\u0440\u0435\u0437 2 \u0447\u0430\u0441\u0430 \u043f\u0440\u0438\u043d\u044f\u0442\u044c \u043b\u0435\u043a\u0430\u0440\u0441\u0442\u0432\u043e.";break;default:t="\u041c\u043d\u0435 \u043d\u0443\u0436\u043d\u0430 \u043f\u043e\u043c\u043e\u0449\u044c."}await N(t)};return(0,s.jsx)("div",{className:"min-h-screen",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-4 space-y-3",children:[!m&&(0,s.jsx)(r,{onDone:()=>h(!0)}),m&&b&&(0,s.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-2xl p-4 text-sm",children:[(0,s.jsx)("div",{className:"font-medium mb-1",children:"\u041c\u043e\u0436\u043d\u043e \u044f \u0437\u0430\u0434\u0430\u043c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0445 \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u0432? \u042d\u0442\u043e \u0437\u0430\u0439\u043c\u0451\u0442 5\u201310 \u043c\u0438\u043d\u0443\u0442 \u0438 \u043f\u043e\u043c\u043e\u0436\u0435\u0442 \u043c\u043d\u0435 \u0433\u043e\u0432\u043e\u0440\u0438\u0442\u044c \u0441 \u0442\u043e\u0431\u043e\u0439 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u043a\u043e\u043c\u0444\u043e\u0440\u0442\u043d\u043e."}),(0,s.jsx)(o(),{href:"/profiling/attitude",className:"inline-block px-3 py-1.5 rounded-xl bg-emerald-600 text-white",children:"\u0414\u0430, \u043f\u0440\u043e\u0439\u0442\u0438 \u043e\u043f\u0440\u043e\u0441 \u2192"})]}),m&&!b&&(0,s.jsxs)("div",{className:"bg-white rounded-2xl p-4 shadow-sm",children:[(0,s.jsx)("div",{className:"text-sm text-gray-600 mb-3",children:"\u0411\u044b\u0441\u0442\u0440\u044b\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f:"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)("button",{onClick:()=>j("anxious"),className:"px-3 py-2 bg-red-50 text-red-700 rounded-xl hover:bg-red-100 transition-colors text-sm",children:"\ud83d\ude30 \u041e\u0447\u0435\u043d\u044c \u043f\u0435\u0440\u0435\u0436\u0438\u0432\u0430\u044e"}),(0,s.jsx)("button",{onClick:()=>j("drug_info"),className:"px-3 py-2 bg-blue-50 text-blue-700 rounded-xl hover:bg-blue-100 transition-colors text-sm",children:"\ud83d\udc8a \u0420\u0430\u0441\u0441\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0440\u043e \u043f\u0440\u0435\u043f\u0430\u0440\u0430\u0442"}),(0,s.jsx)("button",{onClick:()=>j("where_to_go"),className:"px-3 py-2 bg-green-50 text-green-700 rounded-xl hover:bg-green-100 transition-colors text-sm",children:"\ud83c\udfe5 \u041a\u0443\u0434\u0430 \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u044c\u0441\u044f"}),(0,s.jsx)("button",{onClick:()=>j("book"),className:"px-3 py-2 bg-purple-50 text-purple-700 rounded-xl hover:bg-purple-100 transition-colors text-sm",children:"\ud83d\udcc5 \u0417\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u043a \u0432\u0440\u0430\u0447\u0443"}),(0,s.jsx)("button",{onClick:()=>j("reminder"),className:"px-3 py-2 bg-orange-50 text-orange-700 rounded-xl hover:bg-orange-100 transition-colors text-sm",children:"\u23f0 \u041d\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c \u0447\u0435\u0440\u0435\u0437 2 \u0447\u0430\u0441\u0430"})]})]}),f&&(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-4 text-sm",children:[(0,s.jsx)("div",{className:"font-medium mb-2 text-blue-900",children:"\u0412\u0430\u0448 \u043f\u0440\u043e\u0444\u0438\u043b\u044c:"}),(0,s.jsxs)("div",{className:"text-blue-800",children:[(0,s.jsxs)("div",{children:["\u0422\u043e\u043d: ",(0,s.jsx)("span",{className:"font-medium",children:(null===(e=f.communication_plan)||void 0===e?void 0:e.tone)||"calm_supportive"})]}),(0,s.jsxs)("div",{children:["\u0414\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0435\u0441\u0441\u0438\u0438: ",(0,s.jsx)("span",{className:"font-medium",children:(null===(t=f.communication_plan)||void 0===t?void 0:t.session_length)||"medium"})]}),(null===(l=f.communication_plan)||void 0===l||null===(n=l.avoid)||void 0===n?void 0:n.length)>0&&(0,s.jsxs)("div",{children:["\u0418\u0437\u0431\u0435\u0433\u0430\u0435\u043c: ",(0,s.jsx)("span",{className:"font-medium",children:f.communication_plan.avoid.join(", ")})]})]})]}),(0,s.jsx)("div",{className:"bg-slate-100/60 rounded-2xl p-3 h-[60vh] overflow-y-auto border",ref:y,children:(0,s.jsx)("div",{className:"space-y-2",children:i.map(((e,t)=>(0,s.jsx)("div",{className:"w-full flex justify-start",children:(0,s.jsx)("div",{className:"max-w-[85%] rounded-2xl shadow p-3 text-sm leading-relaxed ".concat("user"===e.role?"bg-blue-50 ml-auto":"bg-white"),children:e.content})},t)))})}),(0,s.jsxs)("div",{className:"bg-white rounded-2xl border shadow-sm p-2 flex items-center gap-2",children:[(0,s.jsx)("input",{value:d,onChange:e=>u(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),N(d))},placeholder:"\u041e\u043f\u0438\u0448\u0438 \u0441\u0438\u043c\u043f\u0442\u043e\u043c\u044b \u0438\u043b\u0438 \u0437\u0430\u0434\u0430\u0439 \u043c\u0435\u0434\u0438\u0446\u0438\u043d\u0441\u043a\u0438\u0439 \u0432\u043e\u043f\u0440\u043e\u0441\u2026",className:"flex-1 px-3 py-2 outline-none"}),(0,s.jsx)("button",{onClick:()=>N(d),disabled:x,className:"px-4 py-2 bg-emerald-600 text-white rounded-xl disabled:opacity-50",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:"\u0414\u0435\u043c\u043e: \u0430\u0441\u0441\u0438\u0441\u0442\u0435\u043d\u0442 \u0434\u0430\u0451\u0442 \u0444\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u0441\u043f\u0440\u0430\u0432\u043a\u0443 \u043f\u043e \u043f\u0440\u0435\u043f\u0430\u0440\u0430\u0442\u0430\u043c \u0431\u0435\u0437 \u0434\u043e\u0437\u0438\u0440\u043e\u0432\u043e\u043a \u0438 \u043d\u0435 \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u0442 \u043b\u0435\u0447\u0435\u043d\u0438\u0435. \u041f\u0440\u0438 \u043e\u043f\u0430\u0441\u043d\u044b\u0445 \u0441\u0438\u043c\u043f\u0442\u043e\u043c\u0430\u0445 \u2014 \u0432\u044b\u0437\u044b\u0432\u0430\u0439\u0442\u0435 \u0441\u043a\u043e\u0440\u0443\u044e."})]})})}}},function(e){e.O(0,[664,774,888,179],(function(){return t=5557,e(e.s=t);var t}));var t=e.O();_N_E=t}]);