(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[296],{5005:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profiling/values",function(){return a(5512)}])},5512:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return o}});var l=a(5893),t=a(7294),r=a(1163),n=a(1664),c=a.n(n);function o(){const e=(0,r.useRouter)(),[s,a]=(0,t.useState)(1),[n,o]=(0,t.useState)([]),[i,d]=(0,t.useState)({}),[m,g]=(0,t.useState)([]),[h,b]=(0,t.useState)(!1),[x,u]=(0,t.useState)(0),p=[{name:"red",label:"\u041a\u0440\u0430\u0441\u043d\u044b\u0439",class:"bg-red-500"},{name:"blue",label:"\u0421\u0438\u043d\u0438\u0439",class:"bg-blue-500"},{name:"green",label:"\u0417\u0435\u043b\u0435\u043d\u044b\u0439",class:"bg-green-500"},{name:"yellow",label:"\u0416\u0435\u043b\u0442\u044b\u0439",class:"bg-yellow-400"},{name:"purple",label:"\u0424\u0438\u043e\u043b\u0435\u0442\u043e\u0432\u044b\u0439",class:"bg-purple-500"},{name:"orange",label:"\u041e\u0440\u0430\u043d\u0436\u0435\u0432\u044b\u0439",class:"bg-orange-500"},{name:"pink",label:"\u0420\u043e\u0437\u043e\u0432\u044b\u0439",class:"bg-pink-500"},{name:"brown",label:"\u041a\u043e\u0440\u0438\u0447\u043d\u0435\u0432\u044b\u0439",class:"bg-yellow-800"},{name:"gray",label:"\u0421\u0435\u0440\u044b\u0439",class:"bg-gray-500"},{name:"black",label:"\u0427\u0435\u0440\u043d\u044b\u0439",class:"bg-gray-900"},{name:"white",label:"\u0411\u0435\u043b\u044b\u0439",class:"bg-white border-2 border-gray-300"}];(0,t.useEffect)((()=>{f(),y()}),[]),(0,t.useEffect)((()=>{j()}),[s,i,m]);const f=async()=>{try{const s=await fetch("/api/profiling/values/items"),a=await s.json();var e;if(a.success)o(a.items||[]),console.log("\u2705 \u041f\u043e\u043d\u044f\u0442\u0438\u044f \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e:",null===(e=a.items)||void 0===e?void 0:e.length);else console.error("\u274c API \u0432\u0435\u0440\u043d\u0443\u043b \u043e\u0448\u0438\u0431\u043a\u0443:",a.error),o([])}catch(s){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043f\u043e\u043d\u044f\u0442\u0438\u0439:",s),o([])}},y=()=>{{const s=localStorage.getItem("benehab_values_colors"),a=localStorage.getItem("benehab_values_color_rankings");if(s)try{d(JSON.parse(s))}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0446\u0432\u0435\u0442\u043e\u0432:",e)}if(a)try{g(JSON.parse(a))}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0440\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0446\u0432\u0435\u0442\u043e\u0432:",e)}}},N=()=>{localStorage.setItem("benehab_values_colors",JSON.stringify(i)),localStorage.setItem("benehab_values_color_rankings",JSON.stringify(m))},j=()=>{let e=0;if(1===s){e=Object.keys(i).length/n.length*50}else 2===s&&(e=50+m.length/p.length*50);u(Math.min(e,100))},v=()=>Object.keys(i).length===n.length,w=()=>m.length===p.length,_=async()=>{try{const e=await fetch("/api/profiling/pib",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({demographics:JSON.parse(localStorage.getItem("benehab_demographics")||"{}"),attitude_profile:JSON.parse(localStorage.getItem("benehab_attitude_profile")||"{}"),typology_profile:JSON.parse(localStorage.getItem("benehab_typology_profile")||"{}"),values_profile:JSON.parse(localStorage.getItem("benehab_values_profile")||"{}")})});if(e.ok){const s=await e.json();localStorage.setItem("benehab.pib",JSON.stringify(s.pib))}}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 PIB:",e)}};return 0===n.length?(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600 mx-auto mb-4"}),(0,l.jsx)("p",{children:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u043f\u043e\u043d\u044f\u0442\u0438\u044f..."})]})}):(0,l.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,l.jsxs)("div",{className:"max-w-6xl mx-auto p-4",children:[(0,l.jsxs)("div",{className:"bg-white rounded-2xl p-6 mb-6 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"\u0426\u0435\u043d\u043d\u043e\u0441\u0442\u043d\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c"}),(0,l.jsx)(c(),{href:"/",className:"text-emerald-600 hover:text-emerald-700",children:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043a \u0447\u0430\u0442\u0443"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,l.jsxs)("span",{children:["\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441: ",Math.round(x),"%"]}),(0,l.jsxs)("span",{children:["\u042d\u0442\u0430\u043f ",s," \u0438\u0437 2"]})]}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-emerald-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(x,"%")}})})]}),(0,l.jsx)("p",{className:"text-gray-700",children:1===s?"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0446\u0432\u0435\u0442 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u043d\u044f\u0442\u0438\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043b\u0443\u0447\u0448\u0435 \u0432\u0441\u0435\u0433\u043e \u0430\u0441\u0441\u043e\u0446\u0438\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0441 \u0432\u0430\u0448\u0438\u043c\u0438 \u0447\u0443\u0432\u0441\u0442\u0432\u0430\u043c\u0438.":"\u0420\u0430\u0441\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u0446\u0432\u0435\u0442\u0430 \u043f\u043e \u043f\u043e\u0440\u044f\u0434\u043a\u0443 \u043e\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u043f\u0440\u0438\u044f\u0442\u043d\u043e\u0433\u043e \u0434\u043e \u0441\u0430\u043c\u043e\u0433\u043e \u043d\u0435\u043f\u0440\u0438\u044f\u0442\u043d\u043e\u0433\u043e."})]}),1===s&&(0,l.jsxs)("div",{className:"bg-white rounded-2xl p-6 mb-6 shadow-sm",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"\u042d\u0442\u0430\u043f 1: \u0426\u0432\u0435\u0442\u043e\u0432\u044b\u0435 \u0430\u0441\u0441\u043e\u0446\u0438\u0430\u0446\u0438\u0438"}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map((e=>{var s;return(0,l.jsxs)("div",{className:"border-2 border-gray-200 rounded-lg p-4",children:[(0,l.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:e.concept}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.description}),(0,l.jsx)("div",{className:"grid grid-cols-4 gap-2",children:p.map((s=>(0,l.jsx)("button",{onClick:()=>((e,s)=>{d((a=>({...a,[e]:s}))),N()})(e.concept,s.name),className:"\n                          w-8 h-8 rounded-full transition-all\n                          ".concat(s.class,"\n                          ").concat(i[e.concept]===s.name?"ring-4 ring-emerald-300 scale-110":"hover:scale-105","\n                        "),title:s.label},s.name)))}),i[e.concept]&&(0,l.jsxs)("div",{className:"mt-2 text-sm text-emerald-600",children:["\u2713 \u0412\u044b\u0431\u0440\u0430\u043d: ",null===(s=p.find((s=>s.name===i[e.concept])))||void 0===s?void 0:s.label]})]},e.id)}))}),(0,l.jsxs)("div",{className:"mt-6 text-center",children:[(0,l.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:["\u041e\u043a\u0440\u0430\u0448\u0435\u043d\u043e: ",Object.keys(i).length," \u0438\u0437 ",n.length]}),(0,l.jsx)("button",{onClick:()=>{v()&&a(2)},disabled:!v(),className:"\n                  px-6 py-2 rounded-xl transition-colors\n                  ".concat(v()?"bg-emerald-600 text-white hover:bg-emerald-700":"bg-gray-300 text-gray-500 cursor-not-allowed","\n                "),children:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u0440\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044e \u2192"})]})]}),2===s&&(0,l.jsxs)("div",{className:"bg-white rounded-2xl p-6 mb-6 shadow-sm",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"\u042d\u0442\u0430\u043f 2: \u0420\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0446\u0432\u0435\u0442\u043e\u0432 \u043f\u043e \u043f\u0440\u0438\u0432\u043b\u0435\u043a\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438"}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"\u041e\u0442 \u0441\u0430\u043c\u043e\u0433\u043e \u043f\u0440\u0438\u044f\u0442\u043d\u043e\u0433\u043e \u043a \u0441\u0430\u043c\u043e\u043c\u0443 \u043d\u0435\u043f\u0440\u0438\u044f\u0442\u043d\u043e\u043c\u0443:"}),(0,l.jsx)("div",{className:"space-y-2",children:m.map(((e,s)=>{var a;return(0,l.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[(0,l.jsx)("span",{className:"text-lg font-bold text-emerald-600 w-8",children:s+1}),(0,l.jsx)("div",{className:"w-8 h-8 rounded-full mr-3",style:{backgroundColor:e}}),(0,l.jsx)("span",{className:"flex-1 text-gray-900",children:(null===(a=p.find((s=>s.name===e)))||void 0===a?void 0:a.label)||e}),(0,l.jsxs)("span",{className:"text-sm text-gray-500",children:[Object.keys(i).filter((s=>i[s]===e)).length," \u043f\u043e\u043d\u044f\u0442\u0438\u0439"]})]},e)}))}),m.length<p.length&&(0,l.jsx)("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,l.jsx)("p",{className:"text-yellow-800 text-sm",children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0446\u0432\u0435\u0442\u0430 \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430 \u043d\u0438\u0436\u0435, \u0447\u0442\u043e\u0431\u044b \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0440\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"})})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0446\u0432\u0435\u0442\u0430:"}),(0,l.jsx)("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-3",children:p.filter((e=>!m.includes(e.name))).map((e=>(0,l.jsxs)("button",{onClick:()=>((e,s)=>{let a=[...m];const l=a.indexOf(e);-1!==l&&a.splice(l,1),a.splice(s,0,e),g(a),N()})(e.name,m.length),className:"flex flex-col items-center p-3 border border-gray-200 rounded-lg hover:border-emerald-300 hover:bg-emerald-50 transition-colors",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-full mb-2 ".concat(e.class)}),(0,l.jsx)("span",{className:"text-xs text-gray-700 text-center",children:e.label})]},e.name)))})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("button",{onClick:()=>{a(1)},className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-xl hover:border-emerald-400 hover:text-emerald-600 transition-colors",children:"\u2190 \u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043a \u0446\u0432\u0435\u0442\u0430\u043c"}),(0,l.jsx)("button",{onClick:async()=>{if(w()){b(!0);try{const s=await fetch("/api/profiling/values/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({colorAssociations:i,colorRankings:m})});if(s.ok){const a=await s.json();localStorage.setItem("benehab_values_profile",JSON.stringify(a.profile)),await _(),e.push("/profiling/values-results")}else{const e=await s.text();console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u043e\u0442\u0432\u0435\u0442\u043e\u0432:",s.status,e),alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438: ".concat(s.status))}}catch(s){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u043e\u0442\u0432\u0435\u0442\u043e\u0432:",s),alert("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(s.message))}finally{b(!1)}}},disabled:!w()||h,className:"\n                  px-6 py-2 rounded-xl transition-colors\n                  ".concat(w()&&!h?"bg-emerald-600 text-white hover:bg-emerald-700":"bg-gray-300 text-gray-500 cursor-not-allowed","\n                "),children:h?"\u0417\u0430\u0432\u0435\u0440\u0448\u0430\u0435\u043c...":"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u043e\u043f\u0440\u043e\u0441"})]})]}),(0,l.jsx)("div",{className:"text-center text-sm text-gray-500 mt-4",children:"\u0412\u0430\u0448\u0438 \u043e\u0442\u0432\u0435\u0442\u044b \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044e\u0442\u0441\u044f. \u041f\u043e\u0441\u043b\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u0432\u044b \u0441\u043c\u043e\u0436\u0435\u0442\u0435 \u043e\u0431\u0449\u0430\u0442\u044c\u0441\u044f \u0441 \u0422\u0430\u0442\u044c\u044f\u043d\u043e\u0439 \u0432 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435."})]})})}},1163:function(e,s,a){e.exports=a(9974)}},function(e){e.O(0,[664,774,888,179],(function(){return s=5005,e(e.s=s);var s}));var s=e.O();_N_E=s}]);