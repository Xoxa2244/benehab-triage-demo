"use strict";(()=>{var e={id:170,ids:[170]};e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2079:e=>{e.exports=import("openai")},6586:(e,n,t)=>{t.a(e,(async(e,a)=>{try{t.r(n),t.d(n,{config:()=>l,default:()=>p,routeModule:()=>u});var i=t(1802),o=t(7153),s=t(6249),r=t(5842),c=e([r]);r=(c.then?(await c)():c)[0];const p=(0,s.l)(r,"default"),l=(0,s.l)(r,"config"),u=new i.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/chat",pathname:"/api/chat",bundlePath:"",filename:""},userland:r});a()}catch(p){a(p)}}))},5842:(e,n,t)=>{t.a(e,(async(e,a)=>{try{t.r(n),t.d(n,{default:()=>l});var i=t(2079),o=e([i]);const r=new((i=(o.then?(await o)():o)[0]).default)({apiKey:process.env.OPENAI_API_KEY}),c='\u0422\u044b \u2014 "\u0422\u0430\u0442\u044c\u044f\u043d\u0430", \u0430\u0441\u0441\u0438\u0441\u0442\u0435\u043d\u0442 \u043f\u043e \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u044e Benehab.\n\u0413\u043e\u0432\u043e\u0440\u0438 \u0442\u0451\u043f\u043b\u043e \u0438 \u043f\u0440\u043e\u0441\u0442\u043e. \u0423\u0432\u0430\u0436\u0430\u0439 \u0432\u044b\u0431\u043e\u0440 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430. \n\u041d\u0435 \u0441\u0442\u0430\u0432\u044c \u0434\u0438\u0430\u0433\u043d\u043e\u0437\u044b, \u043d\u0435 \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0439 \u043b\u0435\u043a\u0430\u0440\u0441\u0442\u0432\u0430.\nTriage: \u0435\u0441\u043b\u0438 \u0435\u0441\u0442\u044c \u043e\u043f\u0430\u0441\u043d\u044b\u0435 \u0441\u0438\u043c\u043f\u0442\u043e\u043c\u044b \u2014 \u043d\u0435\u043c\u0435\u0434\u043b\u0435\u043d\u043d\u043e \u0441\u043e\u0432\u0435\u0442\u0443\u0439 \u0432\u044b\u0437\u0432\u0430\u0442\u044c \u0441\u043a\u043e\u0440\u0443\u044e/\u043e\u0431\u0440\u0430\u0442\u0438\u0442\u044c\u0441\u044f \u0432 \u043d\u0435\u043e\u0442\u043b\u043e\u0436\u043a\u0443 \u0438 \u043d\u0435 \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u0439 \u043e\u0431\u044b\u0447\u043d\u0443\u044e \u0431\u0435\u0441\u0435\u0434\u0443 \u043f\u043e\u043a\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c.\n\u041b\u0451\u0433\u043a\u0438\u0435 \u0442\u0438\u043f\u0438\u0447\u043d\u044b\u0435 \u0441\u0438\u043c\u043f\u0442\u043e\u043c\u044b \u2014 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430, \u043e\u0442\u0434\u044b\u0445/\u0436\u0438\u0434\u043a\u043e\u0441\u0442\u044c/\u0441\u0430\u043c\u043e\u043d\u0430\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0435.\n\u0421\u0440\u0435\u0434\u043d\u0438\u0435, \u0442\u0440\u0435\u0431\u0443\u044e\u0449\u0438\u0435 \u043d\u0430\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u044f \u2014 \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f \u043a \u0432\u0440\u0430\u0447\u0443, \u043d\u043e \u0441\u043b\u043e\u0442\u044b \u0434\u0430\u0432\u0430\u0439 \u0442\u043e\u043b\u044c\u043a\u043e \u0435\u0441\u043b\u0438 \u0447\u0435\u043b\u043e\u0432\u0435\u043a \u0441\u043e\u0433\u043b\u0430\u0441\u0438\u043b\u0441\u044f.\n\u041f\u0440\u0435\u043f\u0430\u0440\u0430\u0442\u044b: \u0434\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u0442\u0441\u044f \u0444\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0441\u043f\u0440\u0430\u0432\u043a\u0430 (\u043f\u043e\u043a\u0430\u0437\u0430\u043d\u0438\u044f, \u043f\u0440\u043e\u0442\u0438\u0432\u043e\u043f\u043e\u043a\u0430\u0437\u0430\u043d\u0438\u044f, \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u043e\u0440\u043e\u0436\u043d\u043e\u0441\u0442\u0438, \u0447\u0430\u0441\u0442\u044b\u0435 \u043f\u043e\u0431\u043e\u0447\u043d\u044b\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u044b) \u2014 \u0411\u0415\u0417 \u0434\u043e\u0437\u0438\u0440\u043e\u0432\u043e\u043a \u0438 \u0431\u0435\u0437 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f. \u0415\u0441\u043b\u0438 \u043f\u0440\u043e\u0441\u044f\u0442 \u0434\u043e\u0437\u0443 \u2014 \u043d\u0430\u043f\u043e\u043c\u043d\u0438, \u0447\u0442\u043e \u0434\u043e\u0437\u0438\u0440\u043e\u0432\u043a\u0438 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u0432\u0440\u0430\u0447.\n\u0421\u043b\u043e\u0442\u044b \u0434\u043b\u044f \u0437\u0430\u043f\u0438\u0441\u0438: 13:00, 15:00, 17:00 \u2014 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0441\u043b\u0435 \u044f\u0432\u043d\u043e\u0433\u043e \u0441\u043e\u0433\u043b\u0430\u0441\u0438\u044f. \u041f\u043e\u0441\u043b\u0435 \u0432\u044b\u0431\u043e\u0440\u0430 \u0441\u043a\u0430\u0436\u0438: "\u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u0432\u044b \u0437\u0430\u043f\u0438\u0441\u0430\u043d\u044b".';function p(e){if(!e||!e.communication_plan)return"";const n=e.communication_plan;let t="\n\n[\u041f\u0415\u0420\u0421\u041e\u041d\u0410\u041b\u0418\u0417\u0410\u0426\u0418\u042f] ";if(n.tone){t+=`${{calm_supportive:"\u0413\u043e\u0432\u043e\u0440\u0438 \u0441\u043f\u043e\u043a\u043e\u0439\u043d\u043e \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0449\u0435",engaging_supportive:"\u0411\u0443\u0434\u044c \u0432\u043e\u0432\u043b\u0435\u0447\u0435\u043d\u043d\u044b\u043c \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044e\u0449\u0438\u043c",stable_calm:"\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0439 \u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u044b\u0439 \u0441\u043f\u043e\u043a\u043e\u0439\u043d\u044b\u0439 \u0442\u043e\u043d",reassuring_calm:"\u0423\u0441\u043f\u043e\u043a\u0430\u0438\u0432\u0430\u0439 \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0439 \u0441\u043f\u043e\u043a\u043e\u0439\u0441\u0442\u0432\u0438\u0435",detailed_precise:"\u0414\u0430\u0432\u0430\u0439 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0438 \u0442\u043e\u0447\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e",inspiring_supportive:"\u0412\u0434\u043e\u0445\u043d\u043e\u0432\u043b\u044f\u0439 \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0439"}[n.tone]||n.tone}. `}if("short"===n.session_length?t+="\u0414\u0435\u0440\u0436\u0438 \u043e\u0442\u0432\u0435\u0442\u044b \u043a\u043e\u0440\u043e\u0442\u043a\u0438\u043c\u0438 \u0438 \u043f\u043e \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443. ":"longer"===n.session_length&&(t+="\u041c\u043e\u0436\u0435\u0448\u044c \u0434\u0430\u0432\u0430\u0442\u044c \u0431\u043e\u043b\u0435\u0435 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0435 \u043e\u0431\u044a\u044f\u0441\u043d\u0435\u043d\u0438\u044f. "),n.avoid&&n.avoid.length>0){const e={pressure:"\u0438\u0437\u0431\u0435\u0433\u0430\u0439 \u0434\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0438 \u0441\u043f\u0435\u0448\u043a\u0438",rush:"\u043d\u0435 \u0442\u043e\u0440\u043e\u043f\u0438\u0441\u044c",uncertainty:"\u0434\u0430\u0432\u0430\u0439 \u0447\u0435\u0442\u043a\u0438\u0435 \u043e\u0442\u0432\u0435\u0442\u044b",overwhelming_info:"\u043d\u0435 \u043f\u0435\u0440\u0435\u0433\u0440\u0443\u0436\u0430\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0435\u0439",harsh_criticism:"\u0438\u0437\u0431\u0435\u0433\u0430\u0439 \u0440\u0435\u0437\u043a\u0438\u0445 \u0444\u043e\u0440\u043c\u0443\u043b\u0438\u0440\u043e\u0432\u043e\u043a",sudden_changes:"\u043d\u0435 \u043c\u0435\u043d\u044f\u0439 \u0440\u0435\u0437\u043a\u043e \u0442\u0435\u043c\u0443",complex_decisions:"\u0443\u043f\u0440\u043e\u0449\u0430\u0439 \u0441\u043b\u043e\u0436\u043d\u044b\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u044f",vagueness:"\u0431\u0443\u0434\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c",incomplete_info:"\u0434\u0430\u0432\u0430\u0439 \u043f\u043e\u043b\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e",rushed_explanations:"\u043d\u0435 \u0442\u043e\u0440\u043e\u043f\u0438\u0441\u044c \u0441 \u043e\u0431\u044a\u044f\u0441\u043d\u0435\u043d\u0438\u044f\u043c\u0438",pessimism:"\u0438\u0437\u0431\u0435\u0433\u0430\u0439 \u043f\u0435\u0441\u0441\u0438\u043c\u0438\u0437\u043c\u0430",boring_presentation:"\u0434\u0435\u043b\u0430\u0439 \u043e\u0442\u0432\u0435\u0442\u044b \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043d\u044b\u043c\u0438",cold_approach:"\u0431\u0443\u0434\u044c \u0442\u0435\u043f\u043b\u044b\u043c \u0438 \u044d\u043c\u043f\u0430\u0442\u0438\u0447\u043d\u044b\u043c",lack_of_empathy:"\u043f\u0440\u043e\u044f\u0432\u043b\u044f\u0439 \u044d\u043c\u043f\u0430\u0442\u0438\u044e"};t+=`\u0418\u0437\u0431\u0435\u0433\u0430\u0439: ${n.avoid.map((n=>e[n]||n)).join(", ")}. `}if(n.seek&&n.seek.length>0){const e={recognize_fatigue:"\u043f\u0440\u0438\u0437\u043d\u0430\u0432\u0430\u0439 \u0443\u0441\u0442\u0430\u043b\u043e\u0441\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",slow_pacing:"\u0437\u0430\u043c\u0435\u0434\u043b\u044f\u0439 \u0442\u0435\u043c\u043f \u043f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438",gentle_approach:"\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439 \u043c\u044f\u0433\u043a\u0438\u0439 \u043f\u043e\u0434\u0445\u043e\u0434",patience:"\u043f\u0440\u043e\u044f\u0432\u043b\u044f\u0439 \u0442\u0435\u0440\u043f\u0435\u043d\u0438\u0435",small_steps:"\u0440\u0430\u0437\u0431\u0438\u0432\u0430\u0439 \u043d\u0430 \u043c\u0430\u043b\u0435\u043d\u044c\u043a\u0438\u0435 \u0448\u0430\u0433\u0438",encouragement:"\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0439 \u0438 \u043f\u043e\u043e\u0449\u0440\u044f\u0439",recognition:"\u043f\u0440\u0438\u0437\u043d\u0430\u0432\u0430\u0439 \u0443\u0441\u0438\u043b\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",interactive_approach:"\u0434\u0435\u043b\u0430\u0439 \u043e\u0442\u0432\u0435\u0442\u044b \u0438\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u043c\u0438",positive_feedback:"\u0434\u0430\u0432\u0430\u0439 \u043f\u043e\u0437\u0438\u0442\u0438\u0432\u043d\u0443\u044e \u043e\u0431\u0440\u0430\u0442\u043d\u0443\u044e \u0441\u0432\u044f\u0437\u044c",consistency:"\u0431\u0443\u0434\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c",simple_choices:"\u043f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u0439 \u043f\u0440\u043e\u0441\u0442\u044b\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b",structure:"\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0438\u0440\u0443\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e",clarity:"\u0431\u0443\u0434\u044c \u044f\u0441\u043d\u044b\u043c",reassurance:"\u0443\u0441\u043f\u043e\u043a\u0430\u0438\u0432\u0430\u0439",step_by_step:"\u043e\u0431\u044a\u044f\u0441\u043d\u044f\u0439 \u043f\u043e\u0448\u0430\u0433\u043e\u0432\u043e",full_info:"\u0434\u0430\u0432\u0430\u0439 \u043f\u043e\u043b\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e",emotional_connection:"\u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0439 \u044d\u043c\u043e\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0432\u044f\u0437\u044c",understanding:"\u043f\u0440\u043e\u044f\u0432\u043b\u044f\u0439 \u043f\u043e\u043d\u0438\u043c\u0430\u043d\u0438\u0435",support:"\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0439 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0443",calm_environment:"\u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0439 \u0441\u043f\u043e\u043a\u043e\u0439\u043d\u0443\u044e \u0430\u0442\u043c\u043e\u0441\u0444\u0435\u0440\u0443",accuracy:"\u0431\u0443\u0434\u044c \u0442\u043e\u0447\u043d\u044b\u043c"};t+=`\u0421\u0442\u0440\u0435\u043c\u0438\u0441\u044c \u043a: ${n.seek.map((n=>e[n]||n)).join(", ")}. `}if(n.educational_focus&&n.educational_focus.length>0){const e={evidence_explain:"\u043e\u0431\u044a\u044f\u0441\u043d\u044f\u0439 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0434\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432",safety_monitor:"\u043e\u0431\u0440\u0430\u0449\u0430\u0439 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435 \u043d\u0430 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c",benefit_explanation:"\u043e\u0431\u044a\u044f\u0441\u043d\u044f\u0439 \u043f\u043e\u043b\u044c\u0437\u0443",risk_benefit_balance:"\u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u0443\u0439 \u0440\u0438\u0441\u043a\u0438 \u0438 \u043f\u043e\u043b\u044c\u0437\u0443",detailed_explanations:"\u0434\u0430\u0432\u0430\u0439 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0435 \u043e\u0431\u044a\u044f\u0441\u043d\u0435\u043d\u0438\u044f",comprehensive_info:"\u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0439 \u043f\u043e\u043b\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e",prevention:"\u0444\u043e\u043a\u0443\u0441\u0438\u0440\u0443\u0439\u0441\u044f \u043d\u0430 \u043f\u0440\u043e\u0444\u0438\u043b\u0430\u043a\u0442\u0438\u043a\u0435"};t+=`\u041e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0444\u043e\u043a\u0443\u0441: ${n.educational_focus.map((n=>e[n]||n)).join(", ")}. `}return e.attitude_profile?.risk_tags&&e.attitude_profile.risk_tags.length>0&&(t+=`\u041e\u0441\u043e\u0431\u043e\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435: ${e.attitude_profile.risk_tags.join(", ")}. `),t}async function l(e,n){if("POST"!==e.method)return n.status(405).json({error:"Method not allowed"});try{const{messages:t=[],meta:a={}}=e.body||{},i=p(a.pib),o=c+i,s=await r.chat.completions.create({model:"gpt-4o-mini",temperature:.7,messages:[{role:"system",content:o},...t]});n.status(200).json({content:s.choices?.[0]?.message?.content||"\u0413\u043e\u0442\u043e\u0432\u043e."})}catch(t){console.error(t),n.status(500).json({error:"Server error"})}}a()}catch(s){a(s)}}))}};var n=require("../../webpack-api-runtime.js");n.C(e);var t=n.X(0,[222],(()=>{return e=6586,n(n.s=e);var e}));module.exports=t})();