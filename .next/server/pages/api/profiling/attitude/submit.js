"use strict";(()=>{var e={id:535,ids:[535]};e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},9044:(e,s,i)=>{i.r(s),i.d(s,{config:()=>_,default:()=>l,routeModule:()=>p});var t={};i.r(t),i.d(t,{default:()=>c});var n=i(1802),r=i(7153),a=i(6249),o=i(7147),d=i.n(o),u=i(1017),h=i.n(u);async function c(e,s){if("POST"!==e.method)return s.status(405).json({error:"Method not allowed"});try{const{answers:i}=e.body;if(!i||!Array.isArray(i)||41!==i.length)return s.status(400).json({error:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e 41 \u043e\u0442\u0432\u0435\u0442 \u0434\u043b\u044f \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u043f\u0440\u043e\u0444\u0438\u043b\u044f"});if(!i.every((e=>0===e||1===e||2===e)))return s.status(400).json({error:"\u041e\u0442\u0432\u0435\u0442\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c 0, 1 \u0438\u043b\u0438 2"});const t=h().join(process.cwd(),"data","attitude_thresholds.csv"),n=d().readFileSync(t,"utf-8"),r=function(e,s){if(!e||41!==e.length)throw new Error("\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e 41 \u043e\u0442\u0432\u0435\u0442 \u0434\u043b\u044f \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u043f\u0440\u043e\u0444\u0438\u043b\u044f");const i={severity:[1,2,13,23,33],secondary_gain:[3,14,24,34],hide_resist:[4,15,25,35],work_escape:[5,16,26,36],low_selfesteem:[6,7,17,18,27,28,37,38],alt_med:[8,19,29,39],addictions:[9,10,20,30,40],ignore:[11,21,31,41],anxiety:[12,22,32]},t={};Object.keys(i).forEach((s=>{let n=0;i[s].forEach((s=>{const i=e[s-1];if(void 0!==i&&null!==i){const e=[6,7,8,9,10,17,18,19,20,27,28,29,30,37,38,39,40].includes(s-1+1);n+=e?2-i:i}})),t[s]=n}));const n={};Object.keys(t).forEach((e=>{const i=t[e],r=s[e];i<=r.low_max?n[e]="low":i<=r.med_max?n[e]="medium":n[e]="high"}));const r=[];"high"===n.severity&&r.push("suicide_risk","depression_risk"),"high"===n.secondary_gain&&r.push("secondary_gain_flag"),"high"===n.hide_resist&&r.push("treatment_resistance"),"high"===n.work_escape&&r.push("work_overload"),"high"===n.low_selfesteem&&r.push("depression_risk"),"high"===n.alt_med&&r.push("alt_medicine_pref"),"high"===n.addictions&&r.push("substance_abuse"),"high"===n.ignore&&r.push("treatment_avoidance"),"high"===n.anxiety&&r.push("high_anxiety");const a=[];return"high"===n.severity&&a.push("crisis_intervention","gentle_approach"),"high"===n.secondary_gain&&a.push("address_underlying_issues"),"high"===n.hide_resist&&a.push("build_trust","avoid_stigma"),"high"===n.work_escape&&a.push("work_life_balance"),"high"===n.low_selfesteem&&a.push("positive_reinforcement"),"high"===n.alt_med&&a.push("evidence_based_education"),"high"===n.addictions&&a.push("addiction_support"),"high"===n.ignore&&a.push("treatment_importance"),"high"===n.anxiety&&a.push("anxiety_management"),{version:"A/0.2",raw:t,levels:n,risk_tags:r,comm_flags:a}}(i,function(e){const s=e.trim().split("\n"),i=(s[0].split(","),{});for(let t=1;t<s.length;t++){const e=s[t].split(",");i[e[0]]={low_min:parseInt(e[1]),low_max:parseInt(e[2]),med_min:parseInt(e[3]),med_max:parseInt(e[4]),high_min:parseInt(e[5]),high_max:parseInt(e[6])}}return i}(n)),a=function(e){const{levels:s,risk_tags:i,comm_flags:t}=e;let n="\u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u0447\u0442\u043e \u043f\u043e\u0434\u0435\u043b\u0438\u043b\u0441\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0435\u0439 \u043e \u0441\u0435\u0431\u0435. ";const r=Object.entries(s).filter((([e,s])=>"high"===s)).map((([e,s])=>e));Object.entries(s).filter((([e,s])=>"medium"===s)).map((([e,s])=>e));r.includes("severity")&&(n+="\u042f \u0432\u0438\u0436\u0443, \u0447\u0442\u043e \u0442\u044b \u0441\u0435\u0440\u044c\u0435\u0437\u043d\u043e \u043e\u0442\u043d\u043e\u0441\u0438\u0448\u044c\u0441\u044f \u043a \u0441\u0432\u043e\u0435\u043c\u0443 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044e. ");r.includes("secondary_gain")&&(n+="\u0411\u043e\u043b\u0435\u0437\u043d\u044c \u043c\u043e\u0436\u0435\u0442 \u0434\u0430\u0432\u0430\u0442\u044c \u0442\u0435\u0431\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u044c \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0443 \u0438 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435. ");r.includes("hide_resist")&&(n+="\u0422\u0435\u0431\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043d\u0435\u043a\u043e\u043c\u0444\u043e\u0440\u0442\u043d\u043e \u043e\u0431\u0441\u0443\u0436\u0434\u0430\u0442\u044c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0441\u043e \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u0435\u043c. ");r.includes("work_escape")&&(n+="\u0420\u0430\u0431\u043e\u0442\u0430 \u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u043c\u043e\u0433\u0430\u044e\u0442 \u0442\u0435\u0431\u0435 \u043e\u0442\u0432\u043b\u0435\u043a\u0430\u0442\u044c\u0441\u044f \u043e\u0442 \u043f\u0440\u043e\u0431\u043b\u0435\u043c \u0441\u043e \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u0435\u043c. ");r.includes("low_selfesteem")&&(n+="\u0422\u044b \u043c\u043e\u0436\u0435\u0448\u044c \u0431\u044b\u0442\u044c \u0441\u043a\u043b\u043e\u043d\u0435\u043d \u043a \u0441\u0430\u043c\u043e\u043a\u0440\u0438\u0442\u0438\u043a\u0435. ");r.includes("alt_med")&&(n+="\u0422\u044b \u043e\u0442\u043a\u0440\u044b\u0442 \u043a \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u044b\u043c \u043f\u043e\u0434\u0445\u043e\u0434\u0430\u043c \u043a \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u044e. ");r.includes("addictions")&&(n+="\u0423 \u0442\u0435\u0431\u044f \u0435\u0441\u0442\u044c \u043e\u043f\u044b\u0442 \u0431\u043e\u0440\u044c\u0431\u044b \u0441 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044f\u043c\u0438. ");r.includes("ignore")&&(n+="\u0422\u044b \u0441\u043a\u043b\u043e\u043d\u0435\u043d \u043d\u0430\u0434\u0435\u044f\u0442\u044c\u0441\u044f, \u0447\u0442\u043e \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0440\u0435\u0448\u0430\u0442\u0441\u044f \u0441\u0430\u043c\u0438. ");r.includes("anxiety")&&(n+="\u0422\u044b \u0447\u0430\u0441\u0442\u043e \u0431\u0435\u0441\u043f\u043e\u043a\u043e\u0438\u0448\u044c\u0441\u044f \u043e \u0441\u0432\u043e\u0435\u043c \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u0435. ");t.includes("crisis_intervention")&&(n+="\u042f \u0431\u0443\u0434\u0443 \u043e\u0441\u043e\u0431\u0435\u043d\u043d\u043e \u0432\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u0435\u043d \u0438 \u0431\u0435\u0440\u0435\u0436\u0435\u043d \u0432 \u043e\u0431\u0449\u0435\u043d\u0438\u0438. ");t.includes("gentle_approach")&&(n+="\u042f \u0431\u0443\u0434\u0443 \u0438\u0437\u0431\u0435\u0433\u0430\u0442\u044c \u0434\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0438 \u0441\u043f\u0435\u0448\u043a\u0438. ");t.includes("build_trust")&&(n+="\u042f \u043f\u043e\u0441\u0442\u0430\u0440\u0430\u044e\u0441\u044c \u0437\u0430\u0432\u043e\u0435\u0432\u0430\u0442\u044c \u0442\u0432\u043e\u0435 \u0434\u043e\u0432\u0435\u0440\u0438\u0435. ");t.includes("avoid_stigma")&&(n+="\u042f \u0431\u0443\u0434\u0443 \u0438\u0437\u0431\u0435\u0433\u0430\u0442\u044c \u043b\u044e\u0431\u044b\u0445 \u0444\u043e\u0440\u043c \u0441\u0442\u0438\u0433\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u0438. ");return n+="\u0415\u0441\u043b\u0438 \u0433\u0434\u0435-\u0442\u043e \u0441\u0442\u0430\u043d\u0435\u0442 \u0442\u0440\u0435\u0432\u043e\u0436\u043d\u043e \u2014 \u0441\u043a\u0430\u0436\u0438, \u043c\u044b \u0437\u0430\u043c\u0435\u0434\u043b\u0438\u043c\u0441\u044f.",n}(r);s.status(200).json({success:!0,profile:r,summary:a,message:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d"})}catch(i){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u043f\u0440\u043e\u0444\u0438\u043b\u044f:",i),s.status(500).json({error:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u043f\u0440\u043e\u0444\u0438\u043b\u044f",details:i.message})}}const l=(0,a.l)(t,"default"),_=(0,a.l)(t,"config"),p=new n.PagesAPIRouteModule({definition:{kind:r.x.PAGES_API,page:"/api/profiling/attitude/submit",pathname:"/api/profiling/attitude/submit",bundlePath:"",filename:""},userland:t})}};var s=require("../../../../webpack-api-runtime.js");s.C(e);var i=s.X(0,[222],(()=>{return e=9044,s(s.s=e);var e}));module.exports=i})();