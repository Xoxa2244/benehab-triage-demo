"use strict";(()=>{var e={id:889,ids:[889]};e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},5294:(e,s,t)=>{t.r(s),t.d(s,{config:()=>m,default:()=>d,routeModule:()=>_});var n={};t.r(n),t.d(n,{default:()=>h});var o=t(1802),i=t(7153),r=t(6249),a=t(7147),c=t.n(a),u=t(1017),p=t.n(u);function l(e,s){if(!e||56!==e.length)throw new Error("\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e 56 \u043e\u0442\u0432\u0435\u0442\u043e\u0432 \u0434\u043b\u044f \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u043f\u0440\u043e\u0444\u0438\u043b\u044f");const t={sensitive:[1,2,3,4,5,6,7],dysthymic:[8,9,10,11,12,13,14],demonstrative:[15,16,17,18,19,20,21],unstable:[22,23,24,25,26,27,28],anxious:[29,30,31,32,33,34,35],pedantic:[36,37,38,39,40,41,42],exalted:[43,44,45,46,47,48,49],emotive:[50,51,52,53,54,55,56]},n={};Object.keys(t).forEach((s=>{let o=0;t[s].forEach((s=>{1===e[s-1]&&o++})),n[s]=o}));const o=s.minScoreDominant||5,i=s.margin||1,r=[];Object.keys(n).forEach((e=>{const s=n[e];if(s>=o){let t=!0;Object.keys(n).forEach((o=>{o!==e&&n[o]>=s-i&&(t=!1)})),t&&r.push(e)}}));const a=function(e,s){const t={tone:"calm_supportive",session_length:"medium",avoid:[],seek:[]};return e.forEach((e=>{switch(e){case"sensitive":t.tone="calm_supportive",t.session_length="short",t.avoid.push("pressure","rush","harsh_criticism"),t.seek.push("recognize_fatigue","slow_pacing","gentle_approach");break;case"dysthymic":t.tone="calm_supportive",t.session_length="short",t.avoid.push("pressure","rush","overwhelming_info"),t.seek.push("patience","small_steps","encouragement");break;case"demonstrative":t.tone="engaging_supportive",t.session_length="medium",t.avoid.push("boring_presentation","lack_of_attention"),t.seek.push("recognition","interactive_approach","positive_feedback");break;case"unstable":t.tone="stable_calm",t.session_length="short",t.avoid.push("sudden_changes","complex_decisions","pressure"),t.seek.push("consistency","simple_choices","structure");break;case"anxious":t.tone="reassuring_calm",t.session_length="short",t.avoid.push("uncertainty","pressure","overwhelming_info"),t.seek.push("clarity","reassurance","step_by_step");break;case"pedantic":t.tone="detailed_precise",t.session_length="longer",t.avoid.push("vagueness","incomplete_info","rushed_explanations"),t.seek.push("full_info","structure","detailed_explanations");break;case"exalted":t.tone="inspiring_supportive",t.session_length="medium",t.avoid.push("pessimism","boring_presentation"),t.seek.push("positive_approach","inspiration","enthusiasm");break;case"emotive":t.tone="empathetic_supportive",t.session_length="medium",t.avoid.push("cold_approach","lack_of_empathy"),t.seek.push("emotional_connection","understanding","support")}})),Object.keys(s).forEach((n=>{const o=s[n];o>=4&&!e.includes(n)&&("anxious"===n&&o>=4&&(t.avoid.push("stress"),t.seek.push("calm_environment")),"pedantic"===n&&o>=4&&t.seek.push("accuracy"))})),t}(r,n);return{version:"B/0.1",scores:n,dominant:r,tone_mods:a}}async function h(e,s){if("POST"!==e.method)return s.status(405).json({error:"Method not allowed"});try{const{answers:t}=e.body;if(!t||!Array.isArray(t)||56!==t.length)return s.status(400).json({error:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e 56 \u043e\u0442\u0432\u0435\u0442\u043e\u0432 \u0434\u043b\u044f \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u043f\u0440\u043e\u0444\u0438\u043b\u044f"});if(!t.every((e=>0===e||1===e)))return s.status(400).json({error:"\u041e\u0442\u0432\u0435\u0442\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c 0 \u0438\u043b\u0438 1"});const n=p().join(process.cwd(),"data","typology_thresholds.csv"),o=c().readFileSync(n,"utf-8"),i=l(t,function(e){const s=e.trim().split("\n"),t=(s[0].split(","),{});for(let n=1;n<s.length;n++){const e=s[n].split(",");t.minScoreDominant=parseInt(e[0]),t.margin=parseInt(e[1])}return t}(o)),r=function(e){const{scores:s,dominant:t,tone_mods:n}=e;let o="\u041f\u043e\u043d\u044f\u0442\u043d\u043e, \u0447\u0442\u043e \u0442\u0435\u0431\u0435 \u0431\u043b\u0438\u0436\u0435 ";if(t.length>0){const e={sensitive:"\u0441\u043f\u043e\u043a\u043e\u0439\u043d\u044b\u0439 \u0442\u0435\u043c\u043f \u0438 \u0431\u0435\u0440\u0435\u0436\u043d\u043e\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0435",dysthymic:"\u043f\u043e\u0441\u0442\u0435\u043f\u0435\u043d\u043d\u043e\u0441\u0442\u044c \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430",demonstrative:"\u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435 \u0438 \u043f\u0440\u0438\u0437\u043d\u0430\u043d\u0438\u0435",unstable:"\u0441\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0438 \u043f\u0440\u043e\u0441\u0442\u043e\u0442\u0430",anxious:"\u044f\u0441\u043d\u043e\u0441\u0442\u044c \u0438 \u0443\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0441\u0442\u044c",pedantic:"\u0434\u0435\u0442\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0438 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430",exalted:"\u0432\u0434\u043e\u0445\u043d\u043e\u0432\u0435\u043d\u0438\u0435 \u0438 \u043f\u043e\u0437\u0438\u0442\u0438\u0432",emotive:"\u044d\u043c\u043e\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u0430\u044f \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430"};o+=t.map((s=>e[s]||s)).join(" \u0438 ")+". "}else o+="\u0441\u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u0434\u0445\u043e\u0434. ";if(n.avoid&&n.avoid.length>0){const e={pressure:"\u0434\u0430\u0432\u043b\u0435\u043d\u0438\u044f",rush:"\u0441\u043f\u0435\u0448\u043a\u0438",uncertainty:"\u043d\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0441\u0442\u0438",overwhelming_info:"\u043f\u0435\u0440\u0435\u0433\u0440\u0443\u0437\u043a\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0435\u0439"};o+=`\u042f \u043f\u043e\u0441\u0442\u0430\u0440\u0430\u044e\u0441\u044c \u0438\u0437\u0431\u0435\u0433\u0430\u0442\u044c ${n.avoid.map((s=>e[s]||s)).join(" \u0438 ")}. `}if(n.seek&&n.seek.length>0){const e={slow_pacing:"\u043c\u0435\u0434\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0442\u0435\u043c\u043f\u0430",clarity:"\u044f\u0441\u043d\u043e\u0441\u0442\u0438",structure:"\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b",reassurance:"\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438"};o+=`\u0411\u0443\u0434\u0443 \u0441\u0442\u0440\u0435\u043c\u0438\u0442\u044c\u0441\u044f \u043a ${n.seek.map((s=>e[s]||s)).join(" \u0438 ")}. `}return o+="\u0415\u0441\u043b\u0438 \u0447\u0442\u043e \u2014 \u043f\u043e\u043f\u0440\u0430\u0432\u043b\u044f\u0439 \u043c\u0435\u043d\u044f.",o}(i);s.status(200).json({success:!0,profile:i,summary:r,message:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d"})}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u043f\u0440\u043e\u0444\u0438\u043b\u044f:",t),s.status(500).json({error:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u043f\u0440\u043e\u0444\u0438\u043b\u044f",details:t.message})}}const d=(0,r.l)(n,"default"),m=(0,r.l)(n,"config"),_=new o.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/profiling/typology/submit",pathname:"/api/profiling/typology/submit",bundlePath:"",filename:""},userland:n})}};var s=require("../../../../webpack-api-runtime.js");s.C(e);var t=s.X(0,[222],(()=>{return e=5294,s(s.s=e);var e}));module.exports=t})();