"use strict";(()=>{var e={id:99,ids:[99]};e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3093:(e,s,i)=>{i.r(s),i.d(s,{config:()=>d,default:()=>r,routeModule:()=>l});var n={};i.r(n),i.d(n,{default:()=>u});var o=i(1802),a=i(7153),t=i(6249);async function u(e,s){if("POST"!==e.method)return s.status(405).json({error:"Method not allowed"});try{const{attitude_profile:i,typology_profile:n,patient_meta:o={}}=e.body;if(!i||!n)return s.status(400).json({error:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b \u043e\u0431\u0430 \u043f\u0440\u043e\u0444\u0438\u043b\u044f \u0434\u043b\u044f \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 PIB"});const a=function(e,s,i={}){const n={patient_meta:i,attitude_profile:e,accentuation_profile:s,communication_plan:{}},o={tone:"calm_supportive",session_length:"medium",followup_hint:"ask_in_2h",educational_focus:[],avoid:[],seek:[]};if(e){const{risk_tags:s=[],comm_flags:i=[]}=e;s.includes("alt_medicine_pref")&&(o.educational_focus.push("evidence_explain","safety_monitor"),o.avoid.push("dismissive_attitude")),s.includes("work_overload")&&o.seek.push("work_life_balance","stress_management"),s.includes("depression_risk_check")&&(o.seek.push("mood_monitoring","support_network"),o.avoid.push("pressure","isolation")),s.includes("trust_issues")&&(o.seek.push("build_trust","transparency"),o.avoid.push("authoritarian_tone")),s.includes("medical_avoidance")&&(o.seek.push("gentle_approach","gradual_engagement"),o.avoid.push("pressure","rushed_decisions")),s.includes("family_conflict")&&o.seek.push("family_mediation","individual_support"),s.includes("progression_fear")&&(o.seek.push("reassurance","monitoring_plan"),o.avoid.push("alarmist_language")),i.includes("normalize_fears")&&o.seek.push("normalize_experience","validate_concerns"),i.includes("explain_benefits")&&o.educational_focus.push("benefit_explanation","risk_benefit_balance"),i.includes("avoid_pressure")&&o.avoid.push("pressure","rushed_decisions"),i.includes("provide_details")&&o.educational_focus.push("detailed_explanations","comprehensive_info"),i.includes("build_trust")&&o.seek.push("trust_building","consistent_approach"),i.includes("family_involvement")&&o.seek.push("family_engagement","support_coordination")}if(s){const{tone_mods:e={}}=s;e.tone&&(o.tone=e.tone),e.session_length&&(o.session_length=e.session_length),e.avoid&&o.avoid.push(...e.avoid),e.seek&&o.seek.push(...e.seek)}if(e&&s){const i=e,n=s;n.dominant&&(n.dominant.includes("sensitive")||n.dominant.includes("dysthymic"))&&(o.tone="calm_supportive",o.session_length="short",o.avoid.includes("rush")||o.avoid.push("rush"),o.avoid.includes("pressure")||o.avoid.push("pressure")),n.dominant&&n.dominant.includes("pedantic")&&(o.seek.includes("full_info")||o.seek.push("full_info"),o.seek.includes("structure")||o.seek.push("structure")),i.risk_tags&&i.risk_tags.includes("alt_medicine_pref")&&(o.educational_focus.includes("evidence_explain")||o.educational_focus.push("evidence_explain"),o.educational_focus.includes("safety_monitor")||o.educational_focus.push("safety_monitor")),i.risk_tags&&i.risk_tags.includes("ignore_risk")&&o.seek.push("warning_signs","safety_checks")}return o.avoid=[...new Set(o.avoid)],o.seek=[...new Set(o.seek)],o.educational_focus=[...new Set(o.educational_focus)],n.communication_plan=o,n}(i,n,o);s.status(200).json({success:!0,pib:a,message:"PIB \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u043d"})}catch(i){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 PIB:",i),s.status(500).json({error:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u0438 PIB",details:i.message})}}const r=(0,t.l)(n,"default"),d=(0,t.l)(n,"config"),l=new o.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/profiling/pib",pathname:"/api/profiling/pib",bundlePath:"",filename:""},userland:n})}};var s=require("../../../webpack-api-runtime.js");s.C(e);var i=s.X(0,[222],(()=>{return e=3093,s(s.s=e);var e}));module.exports=i})();