'use client';

import { useState, useEffect } from 'react';
import { UserIcon, HeartIcon, SparklesIcon } from '@heroicons/react/24/outline';

export default function TatianaMessage({ 
  demographics, 
  surveyType, 
  surveyResults, 
  isVisible 
}) {
  const [message, setMessage] = useState('');
  const [isTyping, setIsTyping] = useState(false);

  useEffect(() => {
    if (isVisible && demographics && surveyType) {
      generateMessage();
    }
  }, [isVisible, demographics, surveyType, surveyResults]);

  const generateMessage = () => {
    setIsTyping(true);
    
    // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–µ—á–∞—Ç–∞–Ω–∏–µ
    setTimeout(() => {
      const personalizedMessage = createPersonalizedMessage();
      setMessage(personalizedMessage);
      setIsTyping(false);
    }, 1000);
  };

  const createPersonalizedMessage = () => {
    const { name, gender, age, weight, height } = demographics;
    const genderText = gender === 'male' ? '–º—É–∂—á–∏–Ω–∞' : '–∂–µ–Ω—â–∏–Ω–∞';
    const ageText = getAgeText(age);
    
    let baseMessage = `–ü—Ä–∏–≤–µ—Ç, ${name}! üëã\n\n`;
    
    // –ë–∞–∑–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
    baseMessage += `–Ø —Ä–∞–¥–∞ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –≤–∞–º–∏! –í—ã ${genderText}, ${ageText} –≤–æ–∑—Ä–∞—Å—Ç–∞. `;
    
    // –ê–Ω–∞–ª–∏–∑ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    const bmi = calculateBMI(weight, height);
    if (bmi < 18.5) {
      baseMessage += `–£ –≤–∞—Å —Ö—Ä—É–ø–∫–æ–µ —Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –¥–µ–ª–∏–∫–∞—Ç–Ω–æ—Å—Ç–∏ –∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. `;
    } else if (bmi > 25) {
      baseMessage += `–£ –≤–∞—Å –∫—Ä–µ–ø–∫–æ–µ —Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–∏–ª—É –¥—É—Ö–∞ –∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å. `;
    } else {
      baseMessage += `–£ –≤–∞—Å –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–µ —Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ, —á—Ç–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –±–∞–ª–∞–Ω—Å. `;
    }

    // –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–∞ –æ–ø—Ä–æ—Å–∞
    switch (surveyType) {
      case 'attitude':
        baseMessage += generateAttitudeMessage(surveyResults);
        break;
      case 'typology':
        baseMessage += generateTypologyMessage(surveyResults);
        break;
      case 'values':
        baseMessage += generateValuesMessage(surveyResults);
        break;
      default:
        baseMessage += `–Ø –±—É–¥—É —Ä–∞–¥–∞ –ø–æ–º–æ—á—å –≤–∞–º –≤ —Ä–µ—à–µ–Ω–∏–∏ –≤–∞—à–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤. `;
    }

    // –ó–∞–≤–µ—Ä—à–∞—é—â–∞—è —á–∞—Å—Ç—å
    baseMessage += `\n\n–¢–µ–ø–µ—Ä—å —è –ø–æ–Ω–∏–º–∞—é –≤–∞—Å –≥–æ—Ä–∞–∑–¥–æ –ª—É—á—à–µ –∏ –±—É–¥—É –æ–±—â–∞—Ç—å—Å—è —Å –≤–∞–º–∏ –≤ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–º —Å—Ç–∏–ª–µ. `;
    baseMessage += `–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞, —è –∑–¥–µ—Å—å –¥–ª—è –≤–∞—Å! üíô`;

    return baseMessage;
  };

  const generateAttitudeMessage = (results) => {
    if (!results) return `–Ø –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –±–æ–ª–µ–∑–Ω–∏ - —ç—Ç–æ –æ—á–µ–Ω—å –ª–∏—á–Ω–∞—è —Ç–µ–º–∞. `;
    
    let message = `\n\n–ò—Å—Ö–æ–¥—è –∏–∑ –≤–∞—à–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤ –æ–± –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –∫ –±–æ–ª–µ–∑–Ω–∏, —è –≤–∏–∂—É, —á—Ç–æ `;
    
    // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —à–∫–∞–ª—ã
    const scales = results.scales || {};
    
    if (scales.severity && scales.severity > 5) {
      message += `–≤—ã —Å–µ—Ä—å–µ–∑–Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ—Å—å –∫ —Å–≤–æ–µ–º—É –∑–¥–æ—Ä–æ–≤—å—é –∏ –≥–ª—É–±–æ–∫–æ –ø–µ—Ä–µ–∂–∏–≤–∞–µ—Ç–µ –∑–∞ –Ω–µ–≥–æ. `;
      message += `–Ø –±—É–¥—É –æ—Å–æ–±–µ–Ω–Ω–æ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–∞ –∫ –≤–∞—à–∏–º –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è–º –∏ –ø–æ—Å—Ç–∞—Ä–∞—é—Å—å —Å–æ–∑–¥–∞—Ç—å –æ—â—É—â–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. `;
    } else if (scales.severity && scales.severity < 3) {
      message += `–≤—ã –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ —Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. `;
      message += `–Ø –ø–æ–¥–¥–µ—Ä–∂—É –≤–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –Ω–∞—Å—Ç—Ä–æ–π, –Ω–æ —Ç–∞–∫–∂–µ –ø–æ–º–æ–≥—É –Ω–µ —É–ø—É—Å—Ç–∏—Ç—å –≤–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏. `;
    }
    
    if (scales.anxiety && scales.anxiety > 5) {
      message += `–Ø –∑–∞–º–µ—Ç–∏–ª–∞, —á—Ç–æ –≤—ã —Å–∫–ª–æ–Ω–Ω—ã –∫ —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç–∏. `;
      message += `–í –Ω–∞—à–µ–º –æ–±—â–µ–Ω–∏–∏ —è –±—É–¥—É –¥–∞–≤–∞—Ç—å —á–µ—Ç–∫—É—é, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—â—É—â–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç–∏. `;
    }
    
    if (scales.secondary_gain && scales.secondary_gain > 3) {
      message += `–Ø –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ –±–æ–ª–µ–∑–Ω—å –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–æ—Å–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤—ã–≥–æ–¥—ã. `;
      message += `–Ø –±—É–¥—É –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤–∞—Å, –Ω–æ —Ç–∞–∫–∂–µ –ø–æ–º–æ–≥—É –Ω–∞–π—Ç–∏ –∑–¥–æ—Ä–æ–≤—ã–µ —Å–ø–æ—Å–æ–±—ã –ø–æ–ª—É—á–µ–Ω–∏—è –≤–Ω–∏–º–∞–Ω–∏—è –∏ –∑–∞–±–æ—Ç—ã. `;
    }
    
    return message;
  };

  const generateTypologyMessage = (results) => {
    if (!results) return `–Ø –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ –∫–∞–∂–¥—ã–π —á–µ–ª–æ–≤–µ–∫ —É–Ω–∏–∫–∞–ª–µ–Ω –≤ —Å–≤–æ–µ–º –≤–æ—Å–ø—Ä–∏—è—Ç–∏–∏ –º–∏—Ä–∞. `;
    
    let message = `\n\n–ê–Ω–∞–ª–∏–∑–∏—Ä—É—è –≤–∞—à –ø—Å–∏—Ö–æ—Ç–∏–ø, —è –≤–∏–∂—É, —á—Ç–æ `;
    
    const dominantType = results.dominant_type;
    
    switch (dominantType) {
      case 'sensitive':
        message += `–≤—ã –æ—á–µ–Ω—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –∏ —Ä–∞–Ω–∏–º—ã–π —á–µ–ª–æ–≤–µ–∫. `;
        message += `–Ø –±—É–¥—É –æ–±—â–∞—Ç—å—Å—è —Å –≤–∞–º–∏ –æ—Å–æ–±–µ–Ω–Ω–æ –±–µ—Ä–µ–∂–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—è –º—è–≥–∫–∏–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—è –≤–∞—à–∏ —á—É–≤—Å—Ç–≤–∞. `;
        break;
      case 'dysthymic':
        message += `–≤—ã —Å–∫–ª–æ–Ω–Ω—ã –∫ —Å–∞–º–æ–∫—Ä–∏—Ç–∏–∫–µ –∏ —á–∞—Å—Ç–æ –≤–∏–Ω–∏—Ç–µ —Å–µ–±—è. `;
        message += `–Ø –±—É–¥—É –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞—Ç—å –≤–∞—à–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –¥–∞–≤–∞—Ç—å –º–∞–ª–µ–Ω—å–∫–∏–µ, –¥–æ—Å—Ç–∏–∂–∏–º—ã–µ —à–∞–≥–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—è. `;
        break;
      case 'demonstrative':
        message += `–≤—ã –ª—é–±–∏—Ç–µ –±—ã—Ç—å –≤ —Ü–µ–Ω—Ç—Ä–µ –≤–Ω–∏–º–∞–Ω–∏—è –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ. `;
        message += `–Ø –±—É–¥—É –¥–∞–≤–∞—Ç—å –≤–∞–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º–∏ —É—Å–ø–µ—Ö–∞–º–∏ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º–∏. `;
        break;
      case 'excitable':
        message += `–≤—ã –∏–º–ø—É–ª—å—Å–∏–≤–Ω—ã –∏ –ª—é–±–∏—Ç–µ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –±—ã—Å—Ç—Ä–æ. `;
        message += `–Ø –±—É–¥—É –¥–∞–≤–∞—Ç—å –≤–∞–º –∫—Ä–∞—Ç–∫–∏–µ, —á–µ—Ç–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ –ø–æ–º–æ–≥–∞—Ç—å —Å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–µ–π—Å—Ç–≤–∏–π. `;
        break;
      case 'cyclothymic':
        message += `—É –≤–∞—Å –ø–µ—Ä–µ–º–µ–Ω—á–∏–≤–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. `;
        message += `–Ø –±—É–¥—É –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ –≤–∞—à–µ–º—É —Ç–µ–∫—É—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é –∏ –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –≥–∏–±–∫–∏–µ –ø–ª–∞–Ω—ã. `;
        break;
      case 'stuck':
        message += `–≤—ã —É–ø–æ—Ä–Ω—ã –∏ –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω—ã. `;
        message += `–Ø –±—É–¥—É —É–≤–∞–∂–∞—Ç—å –≤–∞—à–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∏ –ø–æ–º–æ–≥–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å —É–ø–æ—Ä—Å—Ç–≤–æ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–µ —Ä—É—Å–ª–æ. `;
        break;
      case 'pedantic':
        message += `–≤—ã –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã –∏ –ª—é–±–∏—Ç–µ –ø–æ—Ä—è–¥–æ–∫. `;
        message += `–Ø –±—É–¥—É –¥–∞–≤–∞—Ç—å –≤–∞–º –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–ª–∞–Ω—ã. `;
        break;
      case 'anxious':
        message += `–≤—ã —Å–∫–ª–æ–Ω–Ω—ã –∫ –±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤—É –∏ –º–Ω–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. `;
        message += `–Ø –±—É–¥—É —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—â—É—â–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –¥–∞–≤–∞—Ç—å —á–µ—Ç–∫–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏–∏. `;
        break;
      case 'hyperthymic':
        message += `–≤—ã —ç–Ω–µ—Ä–≥–∏—á–Ω—ã –∏ –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã. `;
        message += `–Ø –±—É–¥—É –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤–∞—à —ç–Ω—Ç—É–∑–∏–∞–∑–º –∏ –ø–æ–º–æ–≥–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å —ç–Ω–µ—Ä–≥–∏—é –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–µ —Ä—É—Å–ª–æ. `;
        break;
      default:
        message += `–∫–∞–∂–¥—ã–π —á–µ–ª–æ–≤–µ–∫ —É–Ω–∏–∫–∞–ª–µ–Ω –≤ —Å–≤–æ–µ–º –≤–æ—Å–ø—Ä–∏—è—Ç–∏–∏ –º–∏—Ä–∞. `;
        message += `–Ø –±—É–¥—É –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è –ø–æ–¥ –≤–∞—à–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏. `;
    }
    
    return message;
  };

  const generateValuesMessage = (results) => {
    if (!results) return `–Ø –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ - —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ –ª–∏—á–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞. `;
    
    let message = `\n\n–ê–Ω–∞–ª–∏–∑–∏—Ä—É—è –≤–∞—à—É —Å–∏—Å—Ç–µ–º—É —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π, —è –≤–∏–∂—É, —á—Ç–æ `;
    
    const indices = results.indices || {};
    
    if (indices.life_satisfaction > 0.6) {
      message += `–≤—ã –¥–æ–≤–æ–ª—å–Ω—ã —Å–≤–æ–µ–π –∂–∏–∑–Ω—å—é –∏ —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –±—É–¥—É—â–µ–µ —Å –æ–ø—Ç–∏–º–∏–∑–º–æ–º. `;
      message += `–Ø –±—É–¥—É –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤–∞—à –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –Ω–∞—Å—Ç—Ä–æ–π –∏ –ø–æ–º–æ–≥–∞—Ç—å —É–∫—Ä–µ–ø–ª—è—Ç—å —Ç–æ, —á—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ. `;
    } else if (indices.life_satisfaction < 0.3) {
      message += `–≤—ã –ø–µ—Ä–µ–∂–∏–≤–∞–µ—Ç–µ —Å–ª–æ–∂–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –≤ –∂–∏–∑–Ω–∏. `;
      message += `–Ø –±—É–¥—É –æ—Å–æ–±–µ–Ω–Ω–æ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–∞ –∫ –≤–∞—à–∏–º —á—É–≤—Å—Ç–≤–∞–º –∏ –ø–æ–º–æ–≥—É –Ω–∞–π—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Ä–∞–¥–æ—Å—Ç–∏ –∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏—è. `;
    }
    
    if (indices.future_orientation > 0.5) {
      message += `–í—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ –∏ —Å—Ç–∞–≤–∏—Ç–µ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Ü–µ–ª–∏. `;
      message += `–Ø –±—É–¥—É –ø–æ–º–æ–≥–∞—Ç—å –≤–∞–º –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∏ –¥–æ—Å—Ç–∏–≥–∞—Ç—å —ç—Ç–∏—Ö —Ü–µ–ª–µ–π. `;
    } else {
      message += `–í—ã –±–æ–ª—å—à–µ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –Ω–∞ –Ω–∞—Å—Ç–æ—è—â–µ–º –º–æ–º–µ–Ω—Ç–µ. `;
      message += `–Ø –±—É–¥—É –ø–æ–º–æ–≥–∞—Ç—å –≤–∞–º –Ω–∞—Ö–æ–¥–∏—Ç—å –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ç–µ–∫—É—â–∏–º–∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º–∏ –∏ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–º–∏ –ø–ª–∞–Ω–∞–º–∏. `;
    }
    
    if (indices.self_attitude > 0.6) {
      message += `–£ –≤–∞—Å –∑–¥–æ—Ä–æ–≤–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ —Å–µ–±–µ –∏ –≤—ã—Å–æ–∫–∞—è —Å–∞–º–æ–æ—Ü–µ–Ω–∫–∞. `;
      message += `–Ø –±—É–¥—É –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤–∞—à—É —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø–æ–º–æ–≥–∞—Ç—å —Ä–∞–∑–≤–∏–≤–∞—Ç—å —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã. `;
    } else {
      message += `–í—ã –∏–Ω–æ–≥–¥–∞ —Å–æ–º–Ω–µ–≤–∞–µ—Ç–µ—Å—å –≤ —Å–µ–±–µ. `;
      message += `–Ø –±—É–¥—É –ø–æ–º–æ–≥–∞—Ç—å –≤–∞–º –≤–∏–¥–µ—Ç—å —Å–≤–æ–∏ –¥–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤–∞ –∏ —Ä–∞–∑–≤–∏–≤–∞—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å. `;
    }
    
    return message;
  };

  const getAgeText = (age) => {
    if (age < 18) return '–º–æ–ª–æ–¥–æ–≥–æ';
    if (age < 30) return '–º–æ–ª–æ–¥–æ–≥–æ';
    if (age < 50) return '—Å—Ä–µ–¥–Ω–µ–≥–æ';
    if (age < 65) return '–∑—Ä–µ–ª–æ–≥–æ';
    return '–∑—Ä–µ–ª–æ–≥–æ';
  };

  const calculateBMI = (weight, height) => {
    const heightInMeters = height / 100;
    return weight / (heightInMeters * heightInMeters);
  };

  if (!isVisible || !demographics || !surveyType) {
    return null;
  }

  return (
    <div className="bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg border border-purple-200 p-6 mb-6">
      <div className="flex items-start space-x-4">
        {/* –ê–≤–∞—Ç–∞—Ä –¢–∞—Ç—å—è–Ω—ã */}
        <div className="flex-shrink-0">
          <div className="w-12 h-12 bg-gradient-to-r from-purple-500 to-blue-600 rounded-full flex items-center justify-center">
            <HeartIcon className="w-6 h-6 text-white" />
          </div>
        </div>

        {/* –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏—è */}
        <div className="flex-1 min-w-0">
          <div className="flex items-center space-x-2 mb-2">
            <h3 className="text-lg font-semibold text-gray-900">–¢–∞—Ç—å—è–Ω–∞</h3>
            <span className="text-sm text-gray-500">–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç</span>
          </div>

          {isTyping ? (
            <div className="flex items-center space-x-2 text-gray-600">
              <div className="flex space-x-1">
                <div className="w-2 h-2 bg-purple-400 rounded-full animate-bounce"></div>
                <div className="w-2 h-2 bg-purple-400 rounded-full animate-bounce" style={{ animationDelay: '0.1s' }}></div>
                <div className="w-2 h-2 bg-purple-400 rounded-full animate-bounce" style={{ animationDelay: '0.2s' }}></div>
              </div>
              <span>–¢–∞—Ç—å—è–Ω–∞ –ø–µ—á–∞—Ç–∞–µ—Ç...</span>
            </div>
          ) : (
            <div className="text-gray-700 whitespace-pre-line leading-relaxed">
              {message}
            </div>
          )}
        </div>
      </div>
    </div>
  );
}
